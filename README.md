# ChatGPT Telegram Bot

ChatGPT Telegram Bot – це бот для Telegram, який інтегрується з ChatGPT через OpenAI API. Він дозволяє користувачам:

- Отримувати випадкові цікаві факти.
- Спілкуватися з GPT-моделлю.
- Проводити діалог із "відомими особистостями".
- Брати участь у квізах із генерованими питаннями.
- Перекладати будь-який текст на англійську / українську / чеську / іспанську / французьку мови.
- Вести голосовий діалог із ChatGPT (надсилати голосові повідомлення, отримувати голосову відповідь).

Бот використовує сучасний підхід до організації діалогу за допомогою `ConversationHandler` з бібліотеки [python-telegram-bot](https://github.com/python-telegram-bot/python-telegram-bot) та містить чітко розділену логіку для кожного режиму роботи.
Також до проєкту додано розширене логування для спрощення відлагодження та моніторингу роботи бота.

---

## Функціональність

- **Головне меню:**  
  Користувач може обирати один із режимів роботи:
  - **Випадковий факт:** Бот генерує та надсилає цікавий факт.
  - **GPT-чат:** Діалог із GPT-моделлю, де користувач може ставити запитання.
  - **Діалог з відомою особистістю:** Користувач обирає "особистість" (наприклад, Курт Кобейн або Стівен Хокінг) та спілкується з нею.
  - **Квіз:** Бот генерує питання за обраною темою, а користувач відповідає на них.
  - **Перекладач:** Бот перекладає наданий користувачем текст на обрану цільову мову з наявного списку. GPT відповідає лише перекладеним текстом без додаткових коментарів.
  - **Голосовий чат із GPT:** Користувач може надсилати боту голосові повідомлення, які конвертуються в текст і передаються до ChatGPT, а відповідь від GPT надсилається у вигляді аудіоповідомлення.

- **Обробка діалогу:**  
  Використовується `ConversationHandler` для керування станами діалогу, що робить логіку переходів між режимами зрозумілою та легкою для розширення.

- **Інтеграція з ChatGPT:**  
  Запити до моделі GPT виконуються за допомогою OpenAI API через модуль `gpt.py`. Бот надсилає як системні повідомлення (prompt), так і запити користувача до моделі.

- **Логування:**  
  Для відлагодження та моніторингу роботи бота використовується стандартний модуль `logging`. 
  У всіх основних модулях (bot.py, util.py, gpt.py, credentials.py) додано логування основних подій, помилок та відлагоджувальних повідомлень.

- **Кастомізація повідомлень:**  
  Повідомлення, зображення та prompt-и завантажуються з файлів, що дозволяє легко змінювати контент без модифікації коду.

---

## Використані технології

- **Python 3.8+** – основна мова програмування.
- **python-telegram-bot** – бібліотека для створення Telegram-ботів з підтримкою ConversationHandler.
- **OpenAI API** – інтеграція з ChatGPT.
- **httpx** – HTTP-клієнт для запитів до OpenAI.
- **python-dotenv** – завантаження змінних середовища з файлу .env.
- **SpeechRecognition** – розпізнавання голосових повідомлень (STT).
- **gTTS** – перетворення тексту у мовлення (TTS).
- **ffmpeg** – зовнішня утиліта для конвертації аудіофайлів (OGG ↔ WAV ↔ MP3 ↔ Opus).
- **logging** – стандартний модуль для логування подій, помилок та відлагодження.

---

## Встановлення та налаштування

### Вимоги

- **Python 3.8+**
- Необхідні бібліотеки:
  - `python-telegram-bot`
  - `openai`
  - `httpx`
  - `python-dotenv`
  - `SpeechRecognition`
  - `gTTS`
- **ffmpeg** – має бути встановлений у системі й доступний через команду `ffmpeg`.

### Інструкції з встановлення

1. **Клонування репозиторію:**

   ```bash
   git clone https://github.com/PavNix/CHATGPT.git
   cd your_project
   ```

2. **Створення віртуального середовища та встановлення залежностей:**

- Якщо ви використовуєте pipenv:
   
   ```bash
   pipenv install
   pipenv shell
   ```
   
- Або через pip:

   ```bash
   python -m venv venv
   source venv/bin/activate  # Linux/Mac
   venv\Scripts\activate     # Windows
   pip install -r requirements.txt
   ```
- Окрім основних бібліотек, переконайтеся, що встановлені:
  ```bash
  pip install SpeechRecognition gTTS
  ```
  А також, що на вашій системі встановлено ffmpeg.
  
3. **Налаштування змінних середовища:**
- Створіть файл .env у корені проєкту та додайте наступні змінні:
   
   ```bash
   CHATGPT_TOKEN=your_chatgpt_api_token
   BOT_TOKEN=your_telegram_bot_token
   ```

4.	Інсталяція ffmpeg (якщо ще не встановлено):

- Ubuntu / Debian:

     ```bash
     sudo apt-get update
     sudo apt-get install ffmpeg
     ```

- Windows:
   - Завантажте [офіційні білди ffmpeg](https://ffmpeg.org/download.html#build-windows) або скористайтеся [Chocolatey](https://chocolatey.org/) / [Scoop](https://scoop.sh/).
   - Додайте шлях до ffmpeg.exe у змінну середовища PATH.

- macOS:

     ```bash
     brew install ffmpeg
     ```

5**Запуск бота:**
   
   ```bash
   python bot.py
   ```
   

## Структура проєкту
   
   ```bash
   CHATGPT/
   ├── src/
   │  ├── bot.py                 # Головний файл з логікою діалогу та обробниками
   │  ├── credentials.py         # Завантаження та налаштування токенів з файлу .env
   │  ├── gpt.py                 # Модуль для інтеграції з OpenAI ChatGPT
   │  └── util.py                # Утиліти для надсилання повідомлень, завантаження контенту та управління діалогами
   ├── resources/                # Ресурси проєкту
   │   ├── images/               # Зображення, що використовуються у боті
   │   ├── messages/             # Текстові файли (.txt) з повідомленнями для комунікації
   │   └── prompts/              # Файли (.txt) з prompt-ами для ChatGPT
   ├── .env                      # Файл з конфіденційними змінними (не додається до репозиторію)
   ├── .gitignore                # Файл для ігнорування файлів у Git (наприклад, .env)
   ├── Pipfile / requirements.txt   # Файли для управління залежностями
   ├── README.md                 # Документація проєкту
   └── tasks.md                  # Список задач для реалізації в цьому проєкті та можливі покращення 
   ```

  
## Налаштування ресурсів

- Images:
   Помістіть усі потрібні зображення у папку resources/images. Імена файлів повинні відповідати тим, що використовуються у коді (наприклад, main.jpg, gpt.jpg).

- Messages:
   Текстові файли з повідомленнями зберігаються у resources/messages. Ви можете змінювати контент без зміни коду.

- Prompts:
   Файли з prompt-ами для ChatGPT зберігаються у resources/prompts. Це дозволяє легко налаштовувати поведінку GPT.


## Голосовий чат із GPT

Окрім текстової взаємодії, бот підтримує режим голосового чату. Користувач може відправити голосове повідомлення, яке бот розпізнає (Speech-to-Text) і відправляє до ChatGPT. 
Отримана від ChatGPT відповідь (у текстовому вигляді) потім конвертується у аудіофайл (Text-to-Speech) і надсилається як голосове повідомлення користувачеві.

Вимоги для голосового чату:
	•	SpeechRecognition + ffmpeg (для конвертації OGG → WAV → MP3 / Opus).
	•	gTTS (для Text-to-Speech).
	•	Налаштований виклик /voicechat або кнопка в головному меню, яка переводить бота у стан голосового чату.
 

## Внесення змін та розширення

Проєкт структуровано так, що ви легко можете:
  - Додавати нові режими роботи, використовуючи ConversationHandler.
  - Розширювати функціонал бота, змінюючи файли у папці resources без модифікації коду.
  - Налаштовувати поведінку ChatGPT через файл prompt-ів.
  - Використовувати логування для відслідковування подій, пошуку помилок та аналізу роботи бота.

## Контакти
Якщо у вас виникли запитання або ви хочете повідомити про помилки, звертайтесь за адресою: veronika@pavlichenko.me